<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manga Translator Pro - UI Prototype</title>
    <style>
        :root {
            --bg-dark: #1e1e1e;
            --bg-panel: #252526;
            --bg-input: #3c3c3c;
            --border-color: #454545;
            --accent-color: #007acc;
            --accent-hover: #0062a3;
            --text-primary: #cccccc;
            --text-secondary: #858585;
            --success: #4ec9b0;
            --warning: #ce9178;
            --error: #f48771;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-primary);
            height: 100vh;
            display: flex;
            overflow: hidden;
            font-size: 13px;
        }

        /* --- å·¦ä¾§è¾¹æ  (æ–‡ä»¶ä¸æ ¸å¿ƒæ“ä½œ) --- */
        .sidebar {
            width: 300px;
            background-color: var(--bg-panel);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            padding: 10px;
        }

        .section-title {
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
            color: var(--text-secondary);
            margin-bottom: 8px;
            margin-top: 10px;
        }

        .file-drop-zone {
            border: 2px dashed var(--border-color);
            border-radius: 4px;
            padding: 20px;
            text-align: center;
            color: var(--text-secondary);
            cursor: pointer;
            transition: 0.2s;
            margin-bottom: 10px;
        }
        .file-drop-zone:hover { border-color: var(--accent-color); color: var(--text-primary); }

        .file-list {
            flex: 1;
            background-color: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            overflow-y: auto;
            margin-bottom: 10px;
        }

        .file-item {
            padding: 6px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            font-size: 12px;
        }
        .file-item:last-child { border-bottom: none; }
        .file-item:hover { background-color: #2a2d2e; }
        .file-item .status-icon { margin-right: 8px; }

        .path-input-group {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }
        
        input[type="text"] {
            background-color: var(--bg-input);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 6px;
            border-radius: 2px;
            width: 100%;
        }

        button {
            background-color: var(--bg-input);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 6px 12px;
            cursor: pointer;
            border-radius: 2px;
            transition: 0.2s;
        }
        button:hover { background-color: #4a4a4a; }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
            border: none;
            font-weight: bold;
            padding: 10px;
            width: 100%;
            margin-bottom: 5px;
        }
        .btn-primary:hover { background-color: var(--accent-hover); }
        
        .btn-stop {
            background-color: #c72e2e;
            width: 100%;
            color: white;
            border: none;
            display: none; /* é»˜è®¤éšè— */
        }

        /* --- å³ä¾§ä¸»åŒºåŸŸ (é…ç½®ä¸æ—¥å¿—) --- */
        .main-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* é¡¶éƒ¨ Tab å¯¼èˆª */
        .tabs {
            display: flex;
            background-color: var(--bg-dark);
            border-bottom: 1px solid var(--border-color);
        }
        .tab-btn {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            color: var(--text-secondary);
        }
        .tab-btn.active {
            color: var(--text-primary);
            border-bottom-color: var(--accent-color);
            background-color: #2d2d2d;
        }

        /* é…ç½®å†…å®¹åŒº */
        .config-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: var(--bg-dark);
        }

        .config-panel { display: none; }
        .config-panel.active { display: block; }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group { margin-bottom: 15px; }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-secondary);
        }

        select {
            background-color: var(--bg-input);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 6px;
            width: 100%;
            border-radius: 2px;
        }

        /* æ»‘å—æ ·å¼ */
        .range-wrap { display: flex; align-items: center; gap: 10px; }
        input[type=range] { flex: 1; accent-color: var(--accent-color); }

        /* åº•éƒ¨æ—¥å¿—ä¸è¿›åº¦ */
        .bottom-panel {
            height: 200px;
            background-color: var(--bg-panel);
            border-top: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }

        .progress-bar-container {
            height: 4px;
            background-color: var(--bg-input);
            width: 100%;
        }
        .progress-bar {
            height: 100%;
            background-color: var(--success);
            width: 0%; /* åŠ¨æ€æ”¹å˜ */
            transition: width 0.3s;
        }

        .log-header {
            padding: 5px 10px;
            background-color: #333;
            font-size: 11px;
            display: flex;
            justify-content: space-between;
        }
        
        .console {
            flex: 1;
            padding: 10px;
            font-family: 'Consolas', monospace;
            font-size: 12px;
            overflow-y: auto;
            color: #d4d4d4;
        }
        .log-entry { margin-bottom: 4px; border-bottom: 1px solid #333; padding-bottom: 2px;}
        .log-info { color: #9cdcfe; }
        .log-warn { color: var(--warning); }
        .log-error { color: var(--error); }
        .log-success { color: var(--success); }

        /* å¾½ç«  */
        .badge {
            background: var(--accent-color);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            margin-left: 5px;
        }
    </style>
</head>
<body>

    <!-- å·¦ä¾§ï¼šæ–‡ä»¶ä¸æ ¸å¿ƒæ“ä½œ -->
    <aside class="sidebar">
        <div style="margin-bottom: 20px; font-size: 16px; font-weight: bold; display: flex; align-items: center;">
            <span style="color: var(--accent-color); margin-right: 8px;">â–</span> Manga Translator
        </div>

        <div class="section-title">è¾“å…¥æ–‡ä»¶</div>
        <div class="file-drop-zone" onclick="addSimulatedFiles()">
            + ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶/æ–‡ä»¶å¤¹
        </div>
        
        <div class="section-title" style="display: flex; justify-content: space-between;">
            <span>æ–‡ä»¶åˆ—è¡¨</span>
            <span id="file-count" style="font-weight: normal;">0 items</span>
        </div>
        <div class="file-list" id="file-list-container">
            <!-- JSåŠ¨æ€æ’å…¥æ–‡ä»¶ -->
        </div>
        
        <div style="display: flex; gap: 5px; margin-bottom: 10px;">
            <button onclick="addSimulatedFiles()" style="flex:1">æ·»åŠ æ–‡ä»¶</button>
            <button style="flex:1">æ·»åŠ æ–‡ä»¶å¤¹</button>
            <button style="width: 30px; color: var(--error);" onclick="clearFiles()">Ã—</button>
        </div>

        <div class="section-title">è¾“å‡ºç›®å½•</div>
        <div class="path-input-group">
            <input type="text" value="C:/Downloads/Manga_Output" readonly>
            <button>...</button>
        </div>
        <button style="margin-bottom: 20px;" onclick="alert('æ‰“å¼€è¾“å‡ºæ–‡ä»¶å¤¹')">ğŸ“‚ æ‰“å¼€è¾“å‡ºæ–‡ä»¶å¤¹</button>

        <div style="margin-top: auto;">
            <button class="btn-primary" id="start-btn" onclick="startTask()">ğŸš€ å¼€å§‹ç¿»è¯‘</button>
            <button class="btn-primary btn-stop" id="stop-btn" onclick="stopTask()">ğŸ›‘ åœæ­¢ä»»åŠ¡</button>
            <div style="text-align: center; margin-top: 10px; color: var(--text-secondary); font-size: 11px;">
                çŠ¶æ€: <span id="app-status">å°±ç»ª</span>
            </div>
        </div>
    </aside>

    <!-- å³ä¾§ï¼šä¸»åŒºåŸŸ -->
    <div class="main-area">
        <!-- é…ç½®å¯¼èˆª -->
        <nav class="tabs">
            <div class="tab-btn active" onclick="switchTab(this, 'tab-translate')">ç¿»è¯‘è®¾ç½®</div>
            <div class="tab-btn" onclick="switchTab(this, 'tab-render')">æ¸²æŸ“ä¸æ’ç‰ˆ</div>
            <div class="tab-btn" onclick="switchTab(this, 'tab-image')">å›¾åƒå¤„ç† <span class="badge">OCR</span></div>
            <div class="tab-btn" onclick="switchTab(this, 'tab-advanced')">é«˜çº§/API</div>
        </nav>

        <!-- é…ç½®å†…å®¹ -->
        <div class="config-container">
            
            <!-- 1. ç¿»è¯‘è®¾ç½® -->
            <div id="tab-translate" class="config-panel active">
                <div class="form-grid">
                    <div class="form-group">
                        <label>ç¿»è¯‘å™¨ (Translator)</label>
                        <select onchange="checkHqMode(this)">
                            <option value="gpt-4o">OpenAI GPT-4o (æ¨è)</option>
                            <option value="openai_hq">OpenAI HQ (å¤šæ¨¡æ€é«˜è´¨é‡)</option>
                            <option value="google_gemini">Google Gemini</option>
                            <option value="deepl">DeepL</option>
                            <option value="youdao">æœ‰é“ç¿»è¯‘</option>
                            <option value="sakura">Sakura (æ—¥æ¼«ä¸“ç”¨)</option>
                            <option value="offline">ç¦»çº¿ç¿»è¯‘ (NLLB)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>æºè¯­è¨€ -> ç›®æ ‡è¯­è¨€</label>
                        <div style="display: flex; gap: 10px;">
                            <select disabled><option>è‡ªåŠ¨æ£€æµ‹</option></select>
                            <span style="padding-top:5px;">â”</span>
                            <select>
                                <option value="zh_CN">ç®€ä½“ä¸­æ–‡</option>
                                <option value="zh_TW">ç¹ä½“ä¸­æ–‡</option>
                                <option value="en">English</option>
                                <option value="jp">Japanese</option>
                                <option value="kr">Korean</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Prompt (æç¤ºè¯é£æ ¼)</label>
                        <select>
                            <option>æ ‡å‡†ç¿»è¯‘</option>
                            <option>è½»å°è¯´é£æ ¼</option>
                            <option>æ­¦ä¾ é£æ ¼</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 2. æ¸²æŸ“è®¾ç½® -->
            <div id="tab-render" class="config-panel">
                <div class="form-grid">
                    <div class="form-group">
                        <label>å­—ä½“æ–‡ä»¶ (Font)</label>
                        <div style="display: flex; gap: 5px;">
                            <select>
                                <option>Microsoft YaHei</option>
                                <option>SimHei</option>
                                <option>Arial</option>
                            </select>
                            <button>ğŸ“‚</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>æ–‡å­—é¢œè‰²</label>
                        <input type="color" value="#000000" style="width: 100%; height: 30px; padding: 0; border: none;">
                    </div>
                    <div class="form-group">
                        <label>å­—å·ç¼©æ”¾ (Font Scale)</label>
                        <div class="range-wrap">
                            <span>0.8</span>
                            <input type="range" min="0.5" max="2.0" step="0.1" value="1.0" oninput="this.nextElementSibling.innerText=this.value">
                            <span style="width: 30px;">1.0</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>æ’ç‰ˆæ¨¡å¼ (Layout Mode)</label>
                        <select>
                            <option value="smart_scaling">æ™ºèƒ½ç¼©æ”¾ (Smart Scaling)</option>
                            <option value="balloon_fill">å¡«å……æ°”æ³¡ (Balloon Fill)</option>
                            <option value="strict">ä¸¥æ ¼è¾¹ç•Œ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>æ–¹å‘ (Direction)</label>
                        <select>
                            <option value="auto">è‡ªåŠ¨æ£€æµ‹</option>
                            <option value="v">ç«–æ’ (Vertical)</option>
                            <option value="h">æ¨ªæ’ (Horizontal)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 3. å›¾åƒå¤„ç† -->
            <div id="tab-image" class="config-panel">
                <div class="form-grid">
                    <div class="form-group">
                        <label>OCR æ¨¡å‹</label>
                        <select>
                            <option>MangaOCR (æ¨è)</option>
                            <option>PaddleOCR</option>
                            <option>Windows OCR</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å»å­—/ä¿®å¤ (Inpainter)</label>
                        <select>
                            <option>Lama (æ¨è)</option>
                            <option>Stable Diffusion</option>
                            <option>OpenCV (å¿«é€Ÿ)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>è¶…åˆ†è¾¨ç‡ (Upscale)</label>
                        <select>
                            <option value="none">ä¸ä½¿ç”¨</option>
                            <option value="realcugan">Real-CUGAN (2x)</option>
                            <option value="waifu2x">Waifu2x</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ä¿å­˜æ ¼å¼</label>
                        <select>
                            <option value="jpg">JPEG (é«˜å‹ç¼©)</option>
                            <option value="png">PNG (æ— æŸ)</option>
                            <option value="webp">WebP (æ¨è)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- 4. é«˜çº§/API -->
            <div id="tab-advanced" class="config-panel">
                <div class="form-group">
                    <label style="color: var(--accent-color);">API ç¯å¢ƒå˜é‡ (.env)</label>
                    <div style="background: #333; padding: 10px; border-radius: 4px;">
                        <div class="form-group">
                            <label>OPENAI_API_KEY</label>
                            <input type="password" placeholder="sk-...">
                        </div>
                        <div class="form-group">
                            <label>OPENAI_API_BASE (ä»£ç†åœ°å€)</label>
                            <input type="text" placeholder="https://api.openai.com/v1">
                        </div>
                        <div class="form-group">
                            <label>DEEPL_AUTH_KEY</label>
                            <input type="password" placeholder="...">
                        </div>
                    </div>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label>æ‰¹é‡å¹¶å‘æ•° (Batch Size)</label>
                        <input type="number" value="1" min="1" max="10">
                    </div>
                    <div class="form-group">
                        <label>é‡è¯•æ¬¡æ•° (Attempts)</label>
                        <input type="number" value="3">
                    </div>
                </div>
            </div>

        </div>

        <!-- åº•éƒ¨é¢æ¿ -->
        <div class="bottom-panel">
            <div class="progress-bar-container">
                <div class="progress-bar" id="main-progress"></div>
            </div>
            <div class="log-header">
                <span>è¿è¡Œæ—¥å¿— (Console)</span>
                <div>
                    <button style="padding: 2px 5px; font-size: 10px;" onclick="document.getElementById('console-output').innerHTML=''">æ¸…é™¤</button>
                </div>
            </div>
            <div class="console" id="console-output">
                <div class="log-entry log-info">[System] åº”ç”¨åˆå§‹åŒ–å®Œæˆ</div>
                <div class="log-entry log-info">[Config] å·²åŠ è½½é…ç½®æ–‡ä»¶ config.json</div>
                <div class="log-entry log-info">[System] å°±ç»ªï¼Œç­‰å¾…ä»»åŠ¡...</div>
            </div>
        </div>
    </div>

    <script>
        // --- æ¨¡æ‹Ÿé€»è¾‘ ---

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(btn, tabId) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.querySelectorAll('.config-panel').forEach(p => p.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
        }

        // æ·»åŠ æ¨¡æ‹Ÿæ–‡ä»¶
        function addSimulatedFiles() {
            const fileList = document.getElementById('file-list-container');
            const names = ["Chapter_01_001.jpg", "Chapter_01_002.jpg", "Chapter_01_003.jpg"];
            
            names.forEach(name => {
                const div = document.createElement('div');
                div.className = 'file-item';
                div.innerHTML = `
                    <span style="display:flex; align-items:center;">
                        <span class="status-icon" style="color: #888;">âšª</span> ${name}
                    </span>
                    <span style="color: #666;">[Pending]</span>
                `;
                fileList.appendChild(div);
            });
            updateFileCount();
            log("Added 3 files to the list.", "info");
        }

        function clearFiles() {
            document.getElementById('file-list-container').innerHTML = '';
            updateFileCount();
            log("File list cleared.", "warn");
        }

        function updateFileCount() {
            const count = document.getElementById('file-list-container').children.length;
            document.getElementById('file-count').innerText = count + " items";
        }

        // æ—¥å¿—è¾“å‡º
        function log(msg, type="info") {
            const consoleDiv = document.getElementById('console-output');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            
            const time = new Date().toLocaleTimeString();
            entry.innerText = `[${time}] ${msg}`;
            
            consoleDiv.appendChild(entry);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        // æ¨¡æ‹Ÿä»»åŠ¡å¼€å§‹
        let isRunning = false;
        let progress = 0;
        let timer;

        function startTask() {
            if(document.getElementById('file-list-container').children.length === 0) {
                alert("è¯·å…ˆæ·»åŠ æ–‡ä»¶ï¼");
                return;
            }
            if (isRunning) return;
            
            isRunning = true;
            document.getElementById('start-btn').style.display = 'none';
            document.getElementById('stop-btn').style.display = 'block';
            document.getElementById('app-status').innerText = "æ­£åœ¨ç¿»è¯‘...";
            document.getElementById('app-status').style.color = "var(--success)";
            
            log("Translation worker started.", "info");
            log("Loading model: GPT-4o...", "info");
            
            progress = 0;
            timer = setInterval(() => {
                progress += Math.random() * 5;
                if (progress > 100) progress = 100;
                
                document.getElementById('main-progress').style.width = progress + "%";
                
                // æ¨¡æ‹Ÿæ—¥å¿—æµ
                if (Math.random() > 0.7) {
                    const actions = ["OCR processing...", "Detecting text blocks...", "Inpainting background...", "Translating text...", "Rendering text..."];
                    log(actions[Math.floor(Math.random() * actions.length)], "info");
                }

                if (progress >= 100) {
                    stopTask(true);
                }
            }, 500);
        }

        function stopTask(finished = false) {
            clearInterval(timer);
            isRunning = false;
            document.getElementById('start-btn').style.display = 'block';
            document.getElementById('stop-btn').style.display = 'none';
            document.getElementById('app-status').innerText = finished ? "ä»»åŠ¡å®Œæˆ" : "å·²åœæ­¢";
            document.getElementById('app-status').style.color = finished ? "var(--success)" : "var(--warning)";
            
            if(finished) {
                log("Task completed successfully. 3 files saved.", "success");
            } else {
                log("Task stopped by user.", "warn");
            }
        }
        
        function checkHqMode(select) {
            if(select.value.includes('hq')) {
                log("å·²é€‰æ‹©é«˜è´¨é‡æ¨¡å¼ (HQ Mode): æ­¤æ¨¡å¼æ”¯æŒå¤šæ¨¡æ€è¾“å…¥ï¼Œå°†ç›´æ¥å‘é€å›¾ç‰‡ç»™ AIã€‚", "warn");
            }
        }
    </script>
</body>
</html>